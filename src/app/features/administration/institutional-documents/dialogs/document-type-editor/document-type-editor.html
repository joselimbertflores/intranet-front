<form [formGroup]="form" (ngSubmit)="save()">
  <div class="flex flex-col gap-1 pt-1">
    <p-floatlabel variant="on">
      <label> Nombre</label>
      <input pInputText class="w-full" formControlName="name" />
    </p-floatlabel>
    @if(formUtils.isInvalid(form.get("name"))){
    <p-message severity="error" size="small" variant="simple">
      {{ formUtils.getErrorMessage(form.get("name")) }}
    </p-message>
    }
  </div>
  <div class="flex items-center px-2 mt-2">
    <p-checkbox name="pizza" [binary]="true" formControlName="isActive" />
    <label class="ml-2"> Habilitado </label>
  </div>
  <div class="flex items-center justify-between p-2 mt-4">
    <span class="font-medium text-lg">Listado de subtipos</span>
    <p-button
      icon="pi pi-plus"
      size="small"
      label="Agregar"
      (click)="addSubtype()"
    />
  </div>
  <div class="p-4 border max-h-[400px] overflow-y-auto rounded-lg border-surface-300">
    <div class="flex flex-col gap-y-4" formArrayName="subtypes">
      <div
        *ngFor="let item of subTypes.controls; let i = index"
        [formGroupName]="i"
      >
        <div class="flex gap-x-4 items-center">
          <div class="flex-1">
            <div class="flex flex-col gap-1">
              <p-floatlabel variant="on">
                <label>Nombre subtipo {{ i + 1 }}</label>
                <input pInputText class="w-full" formControlName="name" />
              </p-floatlabel>
              @if(formUtils.isInvalid(item.get("name"))){
              <p-message severity="error" size="small" variant="simple">
                {{ formUtils.getErrorMessage(item.get("name")) }}
              </p-message>
              }
            </div>
          </div>
          <div class="flex items-center">
            <p-checkbox
              name="pizza"
              [binary]="true"
              formControlName="isActive"
            />
            <label class="ml-2"> Habilitado </label>
          </div>
          <p-button
            icon="pi pi-trash"
            [rounded]="true"
            [text]="true"
            (onClick)="removeSubtype(i)"
          />
        </div>
      </div>
      @if(subTypes.controls.length===0){
      <span>Sin elementos.</span>
      }
    </div>
  </div>

  <div class="p-dialog-footer">
    <p-button label="Cancelar" severity="secondary" (onClick)="close()" />
    <p-button type="submit" label="Guardar" [disabled]="form.invalid" />
  </div>
</form>
<p-confirmdialog />