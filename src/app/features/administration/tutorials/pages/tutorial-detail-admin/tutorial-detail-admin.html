<div class="mx-auto max-w-5xl">
  <!-- Header -->
  <div class="mb-8">
    <!-- Volver -->
    <button
      pButton
      icon="pi pi-arrow-left"
      label="Tutoriales"
      class="p-button-text mb-4"
      (click)="goBack()"
    ></button>

    <h1 class="text-3xl font-semibold text-slate-900">
      {{ tutorial.value()?.title }}
    </h1>

    <p class="mt-2 text-slate-600 max-w-3xl">
      {{ tutorial.value()?.summary }}
    </p>

    <div class="flex flex-wrap items-center gap-3 mt-4">
      <p-tag
        [value]="tutorial.value()?.isPublished ? 'Publicado' : 'Borrador'"
        [severity]="tutorial.value()?.isPublished ? 'success' : 'secondary'"
      >
      </p-tag>

      <button
        pButton
        icon="pi pi-pencil"
        label="Editar metadata"
        class="p-button-sm p-button-outlined"
      ></button>

      <button
        *ngIf="tutorial.value()?.isPublished"
        pButton
        icon="pi pi-eye"
        label="Ver público"
        class="p-button-sm p-button-text"
      ></button>
    </div>
  </div>

  <!-- Bloques -->
  <div class="space-y-4">
    <!-- Bloque -->
    <div
      *ngFor="let block of tutorial.value()?.blocks"
      cdkDrag
      class="group bg-white rounded-xl border border-slate-200 p-5 hover:shadow-sm transition"
    >
      <div class="flex justify-between items-start gap-4">
        <!-- Drag + contenido -->
        <div class="flex gap-3">
          <i class="pi pi-bars text-slate-400 cursor-move mt-1" cdkDragHandle>
          </i>

          <div>
            <p class="text-xs uppercase tracking-wide text-slate-400">
              {{ block.type }}
            </p>

            <p class="mt-1 text-slate-700 line-clamp-2">
              {{ block.content || "Archivo adjunto" }}
            </p>
          </div>
        </div>

        <!-- Acciones -->
        <p-menu
          #menu
          [popup]="true"
          [model]="[
            { label: 'Editar', icon: 'pi pi-pencil' },
            { label: 'Eliminar', icon: 'pi pi-trash' },
          ]"
        ></p-menu>

        <button
          pButton
          icon="pi pi-ellipsis-v"
          class="p-button-text opacity-0 group-hover:opacity-100 transition"
          (click)="menu.toggle($event)"
        ></button>
      </div>
    </div>

    <button pButton label="Texto" (click)="openBlockDialog('TEXT')"></button>
    <button pButton label="Imagen" (click)="openBlockDialog('IMAGE')"></button>
    <button pButton label="Video" (click)="openBlockDialog('VIDEO')"></button>
    <button pButton label="Archivo" (click)="openBlockDialog('FILE')"></button>

    <!-- Empty state -->
    <div
      *ngIf="tutorial.value()?.blocks?.length === 0"
      class="text-center py-12 border-2 border-dashed border-slate-200 rounded-xl"
    >
      <p class="text-slate-500 mb-4">
        Este tutorial.value()? aún no tiene contenido
      </p>
      <button
        pButton
        icon="pi pi-plus"
        label="Agregar primer bloque"
        class="p-button-outlined"
      ></button>
    </div>

    <!-- Add block -->
    <button
      pButton
      icon="pi pi-plus"
      label="Agregar bloque"
      class="p-button-outlined w-full mt-6"
    ></button>
  </div>
</div>
