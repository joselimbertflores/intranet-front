<section class="bg-surface-50 border-b">
  <div class="max-w-7xl mx-auto px-4 py-6">
    <h1 class="text-2xl md:text-3xl font-semibold">Comunicados</h1>
    <p class="mt-2 text-sm md:text-base text-muted max-w-2xl">
      Avisos y comunicados oficiales de la institución.
    </p>
  </div>
</section>

<section class="max-w-7xl mx-auto px-4 py-6 space-y-6">
  <div class="w-full flex flex-col gap-2 sm:flex-row justify-end mb-4">
    <div class="w-full md:w-64">
      <search-input (search)="search($event)" />
    </div>
    <div class="w-full md:w-64">
      <p-select
        [showClear]="true"
        [options]="types()"
        optionLabel="name"
        optionValue="id"
        placeholder="Tipo"
        class="w-full"
        [(ngModel)]="type"
      />
    </div>
  </div>

  @if (resource.isLoading() && !dataSource().length) {
    <div class="flex flex-col items-center justify-center py-16">
      <i
        class="pi pi-spin pi-spinner text-4xl mb-4"
        style="font-size: 2rem"
      ></i>
      <p class="font-medium text-surface-500 animate-pulse">
        Cargando comunicados...
      </p>
    </div>
  }

  @if (dataSource().length) {
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      @for (item of dataSource(); track item.id) {
        <communication-card [data]="item" />
      }
    </div>
  }

  @if (!resource.isLoading() && !dataSource().length) {
    <div class="flex flex-col items-center justify-center py-16 text-center">
      <h3 class="text-lg font-semibold text-surface-900 mb-1">
        Sin resultados
      </h3>
      <p class="text-sm text-surface-500 max-w-sm">
        Aún no se han publicado comunicados o ninguno coincide con su búsqueda
        actual.
      </p>
    </div>
  }
  @if (hasMore()) {
    <div class="flex justify-center pt-4">
      <p-button
        severity="secondary"
        [rounded]="true"
        [loading]="resource.isLoading()"
        [label]="resource.isLoading() ? ' Cargando…' : '  Cargar más'"
        (onClick)="loadMore()"
      />
    </div>
  }
</section>
